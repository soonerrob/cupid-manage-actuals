{% extends "base.html" %} {% include "header.html" %} {% block title %} Manage
Actuals {% endblock %} {% block content %}
<div class="container mt-5">
  <h1>Manage Actuals</h1>
  <div class="form-floating mb-3">
    <select
      class="form-select"
      aria-label="KPI Goal"
      name="goal_id"
      id="goal-selector"
      hx-get="/filter_table"
      hx-trigger="change"
      hx-target="#results-table"
    >
      <option value="">Select a KPI Goal</option>
      {% for goal_id, goal_detail in goal_details %}
      <option value="{{ goal_id }}">{{ goal_detail }}</option>
      {% endfor %}
    </select>
    <label for="goal-selector">KPI Goal</label>
  </div>

  <div class="form-floating mb-3">
    <form method="POST" action="{{ url_for('manage_actuals') }}">
      {{ form.hidden_tag() }} {{ form.kpi_goal_id }}

      <div class="form-floating mb-3">
        {{ form.kpi_actual_date(class="form-control", id="floatingDate") }}
        <label for="floatingDate">{{ form.kpi_actual_date.label }}</label>
      </div>

      <div class="form-floating mb-3">
        {{ form.kpi_aa1(class="form-control", id="floatingAA1") }}
        <label for="floatingAA1">{{ form.kpi_aa1.label }}</label>
      </div>

      <div class="form-floating mb-3">
        {{ form.kpi_actual_value(class="form-control", id="floatingValue") }}
        <label for="floatingValue">{{ form.kpi_actual_value.label }}</label>
      </div>

      <div class="form-floating mb-3">
        {{ form.kpi_actual_comment(class="form-control", id="floatingComment")
        }}
        <label for="floatingComment">{{ form.kpi_actual_comment.label }}</label>
      </div>

      {{ form.submit(class="btn btn-primary") }}
    </form>
  </div>

  <table
    class="table table-striped table-hover table-bordered mt-4 delete-row-example"
    id="actuals-table"
  >
    <thead class="table-dark" id="tableHead">
      <tr>
        <th>ID</th>
        <th>DATE</th>
        <th>POSSIBLE VALUE</th>
        <th>ACTUAL VALUE</th>
        <th>COMMENT</th>
        <th>ACTIONS</th>
      </tr>
    </thead>
    <tbody
      id="results-table"
      hx-confirm="Are you sure?"
      hx-target="closest tr"
      hx-swap="outerHTML swap:1s"
    >
      <!-- HTMX will load table data here -->
    </tbody>
  </table>
</div>

<script>
  document
    .getElementById("goal-selector")
    .addEventListener("change", function () {
      var selectedGoalId = this.value;
      console.log("Selected Goal ID:", selectedGoalId); // This will log the selected ID
      document.getElementById("kpi_goal_id").value = selectedGoalId;
      console.log(
        "Hidden field value:",
        document.getElementById("kpi_goal_id").value
      ); // This will log the value set in hidden field
    });
</script>

{% endblock %}
